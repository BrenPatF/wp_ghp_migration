SQL> SELECT 'Start: ' || To_Char(SYSDATE,'DD-MON-YYYY HH24:MI:SS') FROM DUAL;

'START:'||TO_CHAR(SYSDATE,'DD-MON-YY
------------------------------------
Start: 13-JUL-2013 15:50:08

SQL> BEGIN
  2    Utils.Clear_Log;
  3  END;
  4  /

PL/SQL procedure successfully completed.

SQL> BREAK ON tot_dist
SQL> PROMPT Ordered solution
Ordered solution
SQL> WITH legs AS (
  2  SELECT twn.id town_id,
  3         Lag (twn.id) OVER (ORDER BY twn.id) town_id_prior
  4    FROM towns twn
  5  )
  6  SELECT Round (Sum (d.dst) OVER ()) tot_dist,
  7         t.id,
  8         t.name,
  9         Round (d.dst) leg_dist
 10    FROM towns t
 11    JOIN legs l
 12      ON l.town_id = t.id
 13    LEFT JOIN distances d
 14      ON d.a = l.town_id_prior
 15     AND d.b = l.town_id
 16  ORDER BY t.id
 17  /

  TOT_DIST         ID NAME                             LEG_DIST
---------- ---------- ------------------------------ ----------
         7          1 Left Floor
                    2 Left Peak                               2
                    3 Midfield                                1
                    4 Right Peak                              1
                    5 Right Floor                             2

SQL> SET TIMING ON
SQL> @..\sql\Town_SQL 1 5 5
old   2:   :ROOT := &1;
new   2:   :ROOT := 1;
old   3:   :KEEP_NUM_ROOT := &2;
new   3:   :KEEP_NUM_ROOT := 5;
old   4:   :KEEP_NUM := &3;
new   4:   :KEEP_NUM := 5;

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.00
Running for root, keep root, keep values of...

      ROOT
----------
         1


KEEP_NUM_ROOT
-------------
            5


  KEEP_NUM
----------
         5

Top n solutions

ROOT_LEG       PATH_RNK   TOT_DIST    TOWN_ID NAME                             LEG_DIST   CUM_DIST
------------ ---------- ---------- ---------- ------------------------------ ---------- ----------
1 -> 2                1        7.3          1 Left Floor
                                            2 Left Peak                            2.24       2.24
                                            3 Midfield                             1.41       3.65
                                            4 Right Peak                           1.41       5.06
                                            5 Right Floor                          2.24        7.3
                      2       7.89          1 Left Floor
                                            2 Left Peak                            2.24       2.24
                                            4 Right Peak                              2       4.24
                                            3 Midfield                             1.41       5.65
                                            5 Right Floor                          2.24       7.89
                      3       8.12          1 Left Floor
                                            2 Left Peak                            2.24       2.24
                                            3 Midfield                             1.41       3.65
                                            5 Right Floor                          2.24       5.89
                                            4 Right Peak                           2.24       8.12
                      4       8.71          1 Left Floor
                                            2 Left Peak                            2.24       2.24
                                            4 Right Peak                              2       4.24
                                            5 Right Floor                          2.24       6.47
                                            3 Midfield                             2.24       8.71
                      5       9.49          1 Left Floor
                                            2 Left Peak                            2.24       2.24
                                            5 Right Floor                          3.61       5.84
                                            4 Right Peak                           2.24       8.08
                                            3 Midfield                             1.41       9.49
1 -> 3                1       7.89          1 Left Floor
                                            3 Midfield                             2.24       2.24
                                            2 Left Peak                            1.41       3.65
                                            4 Right Peak                              2       5.65
                                            5 Right Floor                          2.24       7.89
                      2       8.71          1 Left Floor
                                            3 Midfield                             2.24       2.24
                                            5 Right Floor                          2.24       4.47
                                            4 Right Peak                           2.24       6.71
                                            2 Left Peak                               2       8.71
                      3       9.26          1 Left Floor
                                            3 Midfield                             2.24       2.24
                                            4 Right Peak                           1.41       3.65
                                            2 Left Peak                               2       5.65
                                            5 Right Floor                          3.61       9.26
                      4       9.49          1 Left Floor
                                            3 Midfield                             2.24       2.24
                                            4 Right Peak                           1.41       3.65
                                            5 Right Floor                          2.24       5.89
                                            2 Left Peak                            3.61       9.49
                      5       9.49          1 Left Floor
                                            3 Midfield                             2.24       2.24
                                            2 Left Peak                            1.41       3.65
                                            5 Right Floor                          3.61       7.26
                                            4 Right Peak                           2.24       9.49
1 -> 4                1       9.26          1 Left Floor
                                            4 Right Peak                           3.61       3.61
                                            2 Left Peak                               2       5.61
                                            3 Midfield                             1.41       7.02
                                            5 Right Floor                          2.24       9.26
                      2       9.49          1 Left Floor
                                            4 Right Peak                           3.61       3.61
                                            5 Right Floor                          2.24       5.84
                                            3 Midfield                             2.24       8.08
                                            2 Left Peak                            1.41       9.49
                      3      10.04          1 Left Floor
                                            4 Right Peak                           3.61       3.61
                                            3 Midfield                             1.41       5.02
                                            2 Left Peak                            1.41       6.43
                                            5 Right Floor                          3.61      10.04
                      4      10.86          1 Left Floor
                                            4 Right Peak                           3.61       3.61
                                            3 Midfield                             1.41       5.02
                                            5 Right Floor                          2.24       7.26
                                            2 Left Peak                            3.61      10.86
                      5      11.45          1 Left Floor
                                            4 Right Peak                           3.61       3.61
                                            2 Left Peak                               2       5.61
                                            5 Right Floor                          3.61       9.21
                                            3 Midfield                             2.24      11.45
1 -> 5                1       9.06          1 Left Floor
                                            5 Right Floor                             4          4
                                            4 Right Peak                           2.24       6.24
                                            3 Midfield                             1.41       7.65
                                            2 Left Peak                            1.41       9.06
                      2       9.65          1 Left Floor
                                            5 Right Floor                             4          4
                                            3 Midfield                             2.24       6.24
                                            4 Right Peak                           1.41       7.65
                                            2 Left Peak                               2       9.65
                      3       9.65          1 Left Floor
                                            5 Right Floor                             4          4
                                            3 Midfield                             2.24       6.24
                                            2 Left Peak                            1.41       7.65
                                            4 Right Peak                              2       9.65
                      4       9.65          1 Left Floor
                                            5 Right Floor                             4          4
                                            4 Right Peak                           2.24       6.24
                                            2 Left Peak                               2       8.24
                                            3 Midfield                             1.41       9.65
                      5      10.43          1 Left Floor
                                            5 Right Floor                             4          4
                                            2 Left Peak                            3.61       7.61
                                            3 Midfield                             1.41       9.02
                                            4 Right Peak                           1.41      10.43

100 rows selected.

Elapsed: 00:00:00.11
SQL> 
SQL> @..\..\Brendan\sql\L_Log_Default

no rows selected

Elapsed: 00:00:00.02
SQL> COMMIT
  2  /

Commit complete.

Elapsed: 00:00:00.00
SQL> SELECT 'End: ' || To_Char(SYSDATE,'DD-MON-YYYY HH24:MI:SS') FROM DUAL;

'END:'||TO_CHAR(SYSDATE,'DD-MON-YY
----------------------------------
End: 13-JUL-2013 15:50:08

Elapsed: 00:00:00.00
SQL> SPOOL OFF
